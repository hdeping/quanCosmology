
# 伯努利数

​	这是彷徨随想系列的第29篇。

​	

​	上一次说到伯努利数（Bernoulli number），今天就来讲讲伯努利数是怎么来的以及关于伯努利数的若干个性质。



## 自然数的平方和

​	我们都听说个一个故事，据说高斯小时候就发现了前n个自然数的求和公式。他的老师大为惊讶，我想高斯的天才也会给他的同班同学不小的心理阴影。前n个自然数的求和公式是这样的
$$
\begin{eqnarray*}
\sum_{k=1}^{n}k&=&\frac{n\left(n+1\right)}{2}
\end{eqnarray*}
$$
​	数学家们不禁会想，前n个自然数的平方和是否可以用公式表达？于是数学家们想了这样一个办法进行求解
$$
\begin{eqnarray*}
\left(k+1\right)^{3}-k^{3}&=&3k^{2}+3k+1,k=1,2,\cdots,n\\\sum_{k=1}^{n}\left[\left(k+1\right)^{3}-k^{3}\right]&=&\sum_{k=1}^{n}\left(3k^{2}+3k+1\right)\\\left(n+1\right)^{3}-1&=&3\sum_{k=1}^{n}k^{2}+3\sum_{k=1}^{n}k+n\\\sum_{k=1}^{n}k^{2}&=&\frac{\left(n+1\right)^{3}-1-n-\frac{3n\left(n+1\right)}{2}}{3}\\&=&\frac{n\left(n+1\right)\left(2n+1\right)}{6}
\end{eqnarray*}
$$

## 等幂求和	

​	我们可以推广到更一般的情况，我们定义一个$P_m(n)$，用以表示前n个自然数的m次方和。我们已经可以计算m=0,1,2时，P的表达式。
$$
\begin{eqnarray*}
P_{m}(n)&=&\sum_{k=1}^{n}k^{m}\\P_{0}(n)&=&n\\P_{1}(n)&=&\frac{n\left(n+1\right)}{2}\\P_{2}(n)&=&\frac{n\left(n+1\right)\left(2n+1\right)}{6}
\end{eqnarray*}
$$
​	对于一般的正整数m，我们可以得到一个递推公式
$$
\begin{eqnarray*}
\left(k+1\right)^{m+1}&=&\sum_{i=0}^{m+1}C_{m+1}^{i}k^{i}\\\sum_{k=1}^{n}\left[\left(k+1\right)^{m+1}-k^{m+1}\right]&=&\sum_{k=1}^{n}\sum_{i=0}^{m}C_{m+1}^{i}k^{i}\\\left(n+1\right)^{m+1}-1&=&\sum_{i=0}^{m}C_{m+1}^{i}P_{i}\left(n\right)\\P_{m}\left(n\right)&=&\frac{\left(n+1\right)^{m+1}-1-\sum_{i=0}^{m-1}C_{m+1}^{i}P_{i}\left(n\right)}{m+1}
\end{eqnarray*}
$$
根据这个递推公式，理论上来讲我们就可以求解任意m对应的P表示，举几个例子
$$
\begin{eqnarray*}
P_{2}\left(n\right)&=&\frac{n\left(n+1\right)\left(2n+1\right)}{6}\\P_{3}\left(n\right)&=&\frac{n^{2}\left(n+1\right)^{2}}{4}\\P_{4}\left(n\right)&=&\frac{n\left(n+1\right)\left(2n+1\right)\left(3n^{2}+3n-1\right)}{30}\\P_{5}\left(n\right)&=&\frac{n^{2}\left(n+1\right)^{2}\left(2n^{2}+2n-1\right)}{12}\\P_{6}\left(n\right)&=&\frac{n\left(n+1\right)\left(2n+1\right)\left(3n^{4}+6n^{3}-3n+1\right)}{42}\\P_{7}\left(n\right)&=&\frac{n^{2}\left(n+1\right)^{2}\left(3n^{4}+6n^{3}-n^{2}-4n+2\right)}{24}\\P_{8}\left(n\right)&=&\frac{n\left(n+1\right)\left(2n+1\right)\left(5n^{6}+15n^{5}+5n^{4}-15n^{3}-n^{2}+9n-3\right)}{90}
\end{eqnarray*}
$$

## 伯努利数

​	对于m次幂的求和公式，我们需要用到前m-1个求和公式，这在计算上无疑会带来不小的麻烦。那么，是否存在更加直接的方式呢？我们先把之前得到的公式展开，看看是否可以得到一些规律
$$
\begin{eqnarray*}
P_{2}\left(n\right)&=&\frac{n^{3}}{3}+\frac{n^{2}}{2}+\frac{n}{6}\\P_{3}\left(n\right)&=&\frac{n^{4}}{4}+\frac{n^{3}}{2}+\frac{n^{2}}{4}\\P_{4}\left(n\right)&=&\frac{n^{5}}{5}+\frac{n^{4}}{2}+\frac{n^{3}}{3}-\frac{n}{30}\\P_{5}\left(n\right)&=&\frac{n^{6}}{6}+\frac{n^{5}}{2}+\frac{5n^{4}}{12}-\frac{n^{2}}{12}\\P_{6}\left(n\right)&=&\frac{n^{7}}{7}+\frac{n^{6}}{2}+\frac{n^{5}}{2}-\frac{n^{3}}{6}+\frac{n}{42}\\P_{7}\left(n\right)&=&\frac{n^{8}}{8}+\frac{n^{7}}{2}+\frac{7n^{6}}{12}-\frac{7n^{4}}{24}+\frac{n^{2}}{12}\\P_{8}\left(n\right)&=&\frac{n^{9}}{9}+\frac{n^{8}}{2}+\frac{2n^{7}}{3}-\frac{7n^{5}}{15}+\frac{2n^{3}}{9}-\frac{n}{30}
\end{eqnarray*}
$$
​	我们大概可以得到这么几个猜测

1. $P_m(n)$是关于n的多项式，而且最高次幂是m+1，对应系数是$1/(m+1)$
2. $P_m(n)$一共有$\left[\frac{n+4}{2}\right]$ 项
3. $P_m(n)$m次幂的系数都是1/2
4. m是偶数时，$P_m(n)$只有m次幂是奇数次幂，其余都是偶数次幂；反之亦然。



​	似乎我们得不出更多规律了。但是这给我们一个启发，似乎我们可以把视线转到$P_m(n)$的系数上。
$$
\begin{eqnarray*}
\left(n+l\right)^{m}&=&\sum_{k=0}^{m}C_{m}^{i}n^{i}l^{m-i}\\P_{m}\left(n+l\right)-P_{m}\left(l\right)&=&\sum_{k=1}^{n}\left(k+l\right)^{m}\\&=&\sum_{k=0}^{m}C_{m}^{i}P_{i}(n)l^{m-i}\\P_{m}^{'}\left(n+l\right)&=&\sum_{k=0}^{m}C_{m}^{i}P_{i}^{'}(n)l^{m-i}\\P_{m}^{'}\left(l\right)&=&\sum_{k=0}^{m}C_{m}^{i}P_{i}^{'}(0)l^{m-i}
\end{eqnarray*}
$$
对上述最后一个公式进行积分，我们可以得到
$$
\begin{eqnarray*}
P_{m}\left(l\right)&=&\sum_{i=0}^{m}\frac{C_{m}^{i}P_{i}^{'}(0)l^{m+1-i}}{m+1-i}\\P_{m}\left(n\right)&=&\sum_{i=0}^{m}\frac{C_{m}^{i}P_{i}^{'}(0)n^{m+1-i}}{m+1-i}\\&=&\frac{1}{m+1}\sum_{i=0}^{m}C_{m+1}^{i}P_{i}^{'}(0)n^{m+1-i}
\end{eqnarray*}
$$
定义$B_i:P_{i}^{'}(0)$，$B_i$就是伯努利数。也就是说，伯努利数其实是一个数列。于是自然数m次幂和是
$$
\begin{eqnarray*}
P_{m}\left(n\right)&=&\frac{1}{m+1}\sum_{i=0}^{m}C_{m+1}^{i}B_{i}n^{m+1-i}
\end{eqnarray*}
$$


​	上式n取1，我们可以得知伯努利数的递推公式
$$
\begin{eqnarray*}
\sum_{i=0}^{m}C_{m+1}^{i}B_{i}&=&m+1\\B_{m}&=&1-\frac{1}{m+1}\sum_{i=0}^{m-1}C_{m+1}^{i}B_{i}
\end{eqnarray*}
$$
​	为了进一步简化上述公式，我们做一个这样的约定$B_i\equiv (B)^i$，就是把第i个系数表示成一个i次方。这样做不能用于计算，但是可以简化公式的形式。

## 

$$
\begin{eqnarray*}
P_{m}\left(n\right)&=&\frac{1}{m+1}\sum_{i=0}^{m}C_{m+1}^{i}B_{i}n^{m+1-i}\\&=&\frac{\left(B+n\right)^{m+1}-B^{m+1}}{m+1}
\end{eqnarray*}
$$



## 伯努利数的生成函数

$$
\begin{eqnarray*}
\frac{x}{e^{x}-1}&=&\sum_{k=0}^{\infty}\frac{B_{k}x^{k}}{k!}
\end{eqnarray*}
$$

​	注意，这里的$B_1$等于$-\frac{1}{2}$

## 正整数倒数偶数次幂之和

​	回到昨天我们挖下的一个坑，$\sum_{n=1}^{\infty}\frac{1}{n^{2m}}$的表达和伯努利数有关
$$
\begin{eqnarray*}
\sum_{n=1}^{\infty}\frac{1}{n^{2m}}&=&\frac{\left|B_{2m}\right|\left(2\pi\right)^{2m}}{2\left(2m\right)!}
\end{eqnarray*}
$$
​	根据这个公式，可以大致估计$B_{2m}$大小
$$
B_{2m} \sim 4\sqrt{\pi m}\left(\frac{m}{\pi e}\right)^{2m}\left(-1\right)^{m-1}
$$




## 参考资料

1. http://mathworld.wolfram.com/BernoulliNumber.html
2. 2019, Nathaniel Larson, The Bernoulli Numbers: A Brief Primer

## 附录

伯努利数的取值
$$
\begin{eqnarray*}
B_{2} & = &  \frac{1}{6} \\
B_{4} & = &  - \frac{1}{30} \\
B_{6} & = &  \frac{1}{42} \\
B_{8} & = &  - \frac{1}{30} \\
B_{10} & = &  \frac{5}{66} \\
B_{12} & = &  - \frac{691}{2730} \\
B_{14} & = &  \frac{7}{6} \\
B_{16} & = &  - \frac{3617}{510} \\
B_{18} & = &  \frac{43867}{798} \\
B_{20} & = &  - \frac{174611}{330} \\
B_{22} & = &  \frac{854513}{138} \\
B_{24} & = &  - \frac{236364091}{2730} \\
B_{26} & = &  \frac{8553103}{6} \\
B_{28} & = &  - \frac{23749461029}{870} \\
B_{30} & = &  \frac{8615841276005}{14322} \\
B_{32} & = &  - \frac{7709321041217}{510} \\
B_{34} & = &  \frac{2577687858367}{6} \\
B_{36} & = &  - \frac{26315271553053477373}{1919190} \\
B_{38} & = &  \frac{2929993913841559}{6} \\
B_{40} & = &  - \frac{261082718496449122051}{13530} \\
B_{42} & = &  \frac{1520097643918070802691}{1806} \\
B_{44} & = &  - \frac{27833269579301024235023}{690} \\
B_{46} & = &  \frac{596451111593912163277961}{282} \\
B_{48} & = &  - \frac{5609403368997817686249127547}{46410} \\
B_{50} & = &  \frac{495057205241079648212477525}{66} \\
B_{52} & = &  - \frac{801165718135489957347924991853}{1590} \\
B_{54} & = &  \frac{29149963634884862421418123812691}{798} \\
B_{56} & = &  - \frac{2479392929313226753685415739663229}{870} \\
B_{58} & = &  \frac{84483613348880041862046775994036021}{354} \\
B_{60} & = &  - \frac{1215233140483755572040304994079820246041491}{56786730} \\
B_{62} & = &  \frac{12300585434086858541953039857403386151}{6} \\
B_{64} & = &  - \frac{106783830147866529886385444979142647942017}{510} \\
B_{66} & = &  \frac{1472600022126335654051619428551932342241899101}{64722} \\
B_{68} & = &  - \frac{78773130858718728141909149208474606244347001}{30} \\
B_{70} & = &  \frac{1505381347333367003803076567377857208511438160235}{4686} \\
B_{72} & = &  - \frac{5827954961669944110438277244641067365282488301844260429}{140100870} \\
B_{74} & = &  \frac{34152417289221168014330073731472635186688307783087}{6} \\
B_{76} & = &  - \frac{24655088825935372707687196040585199904365267828865801}{30} \\
B_{78} & = &  \frac{414846365575400828295179035549542073492199375372400483487}{3318} \\
B_{80} & = &  - \frac{4603784299479457646935574969019046849794257872751288919656867}{230010} \\
B_{82} & = &  \frac{1677014149185145836823154509786269900207736027570253414881613}{498} \\
B_{84} & = &  - \frac{2024576195935290360231131160111731009989917391198090877281083932477}{3404310} \\
B_{86} & = &  \frac{660714619417678653573847847426261496277830686653388931761996983}{6} \\
B_{88} & = &  - \frac{1311426488674017507995511424019311843345750275572028644296919890574047}{61410} \\
B_{90} & = &  \frac{1179057279021082799884123351249215083775254949669647116231545215727922535}{272118} \\
B_{92} & = &  - \frac{1295585948207537527989427828538576749659341483719435143023316326829946247}{1410} \\
B_{94} & = &  \frac{1220813806579744469607301679413201203958508415202696621436215105284649447}{6} \\
B_{96} & = &  - \frac{211600449597266513097597728109824233673043954389060234150638733420050668349987259}{4501770} \\
B_{98} & = &  \frac{67908260672905495624051117546403605607342195728504487509073961249992947058239}{6} \\
B_{100} & = &  - \frac{94598037819122125295227433069493721872702841533066936133385696204311395415197247711}{33330} \\
\end{eqnarray*}
$$


计算代码如下

[Formulas.py](https://github.com/hdeping/mytools/blob/master/mycollections/Formulas.py)

